!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var a in n)("object"==typeof exports?exports:t)[a]=n[a]}}(window,function(){return function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";e.__esModule=!0;var a=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];var r;if(window.hasOwnProperty("wx")&&window.wx.hasOwnProperty(t))return(r=window.wx)[t].apply(r,n)},r="${env}",o=0,i=0,u=0,l=0;function f(t){for(var e,n=arguments.length,a=Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];(e=console).log.apply(e,["WXRank:",t].concat(a))}function c(t){if("production"!=r){for(var e,n=arguments.length,a=Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];(e=console).log.apply(e,["WXRank:",t].concat(a))}}e.default={getOffestX:function(){return o},getOffestY:function(){return i},getDesignWidth:function(){return u},getDesignHeight:function(){return l},init:function(t){f("init..."),f("wxrank version:1.1.1"),Laya.MiniAdpter.init(!0,!0),Laya.init(750,1334),function(t){a("onMessage",function(e){t&&t(e)})}(function(e){try{"filedata"===e.isLoad?(Laya.MiniFileMgr.ziyuFileData[e.url]=e.data,Laya.loader.load(e.url)):"filenative"==e.isLoad?e.isAdd?Laya.MiniFileMgr.filesListObj[e.url]=e.data:delete Laya.MiniFileMgr.filesListObj[e.url]:(c("message:",e),e.action&&"initRank"===e.action&&e.data?(Laya.stage.width=e.data.width,Laya.stage.height=e.data.height,o=e.data.offsetX,i=e.data.offsetY,u=e.data.designWidth,l=e.data.designHeight,Laya.stage.frameRate=Laya.Stage.FRAME_SLOW,Laya.stage.scaleMode=Laya.Stage.SCALE_EXACTFIT):t&&t(e))}catch(t){c("Error",t)}})},setUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a("setUserCloudStorage",t)},getUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a("getUserCloudStorage",t)},removeUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a("removeUserCloudStorage",t)},getFriendCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a("getFriendCloudStorage",t)},getGroupCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a("getGroupCloudStorage",t)},getUserInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a("getUserInfo",t)},printDebug:c,printLog:f}},function(t,e,n){"use strict";var a=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),r=n(2);a.default.init(function(t){"showRank"===t.action&&t.data?(0,r.showRank)(t.data.ui):"hideRank"===t.action&&t.data?(0,r.hideRank)():"setRankKey"===t.action&&t.data?(0,r.setRankKey)(t.data.key,t.data.count,t.data.offset):"setRankScore"===t.action&&t.data&&(0,r.setRankScore)(t.data.key,t.data.score,t.data.extraData)})},function(t,e,n){"use strict";e.__esModule=!0,e.setRankKey=function(t,e,n){u=t,s=e,d=n,g()},e.setRankScore=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=[{key:t,value:JSON.stringify({wxgame:{score:e,update_time:Math.floor(Date.now()/1e3)},extraData:n})}];a.default.setUserCloudStorage({KVDataList:r,success:function(){t==u&&g()}})},e.showRank=function(t){l&&JSON.stringify(t)===JSON.stringify(l)||(l=t,function(){if(l)if(Laya.stage.destroyChildren(),l instanceof Array)l.forEach(function(t){var e=Laya.View.createComp(t);e&&((0,r.bindView)(e,i),Laya.stage.addChild(e))});else{var t=Laya.View.createComp(l);t&&(t.x=a.default.getOffestX(),t.y=a.default.getOffestY(),(0,r.bindView)(t,i),Laya.stage.addChild(t))}}()),g()},e.hideRank=function(){l=null,Laya.stage.destroyChildren()};var a=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),r=n(3),o=n(4),i={},u=null,l=null,f=!0,c=null,s=100,d=0;function g(){c||(c=setTimeout(function(){c=null,l&&u&&f&&(f=!1,(0,o.fetchRankData)(u,s,d,function(t){a.default.printDebug("rankData:",t),i=t,f=!0;for(var e=0;e<Laya.stage.numChildren;e++)(0,r.bindView)(Laya.stage.getChildAt(e),i)}))},200))}},function(t,e,n){"use strict";e.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t}return t}function o(t,e){var n=e.split("|"),a=n[0],o=r(t);t?t[a]?o=r(t[a]):a.split(".").forEach(function(t){o=null!==o&&void 0!==o&&null!==o[t]&&void 0!==o[t]?r(o[t]):null}):o=null;for(var i=[],u=1;u<n.length;u+=2){var l=n[u],f=n.length>u+1?n[u+1]:"";i.push({action:l,target:f})}for(var c=null,s=0;s<i.length;s++){var d=i[s],g=d.action,y=d.target;"default"===g&&(c=y),null!==o&&void 0!==o?"eq"===g&&y!==o.toString()||"neq"===g&&y===o.toString()||"gt"===g&&o<=y||"egt"===g&&o<y||"lt"===g&&o>=y||"elt"===g&&o>y||"like"===g&&o.toString().indexOf(y)<0?o=null:"sub"===g?o.toString().length>Number(y)&&(o=o.toString().substr(0,Number(y))+"..."):"append"===g&&(o=o.toString()+y):o=null}return null===o&&(o=c),o}e.bindView=function t(e,n){for(var i=this,u=r(n),l=0;l<e.numChildren;l++){var f=e.getChildAt(l);if(f.name){var c=o(u,f.name);null!==c&&void 0!==c?(f.visible=!0,f instanceof Laya.List?function(){var e=f;e.array=[],e.repeatX>1&&!e.hScrollBarSkin&&(e.hScrollBarSkin=null),e.repeatY>1&&!e.vScrollBarSkin&&(e.vScrollBarSkin=null),e.renderHandler=Laya.Handler.create(i,function(n,r){var o=e.array[r];"object"===(void 0===o?"undefined":a(o))&&Object.assign(o,{index:r}),t(n,o)},null,!1),e.array=c}():f instanceof Laya.FontClip?f.value=""+c:f instanceof Laya.Label?f.text=""+c:f instanceof Laya.Text?f.text=""+c:f instanceof Laya.Image?f.skin=c:f instanceof Laya.Box?t(f,c):f.value=c):f.visible=!1}}}},function(t,e,n){"use strict";e.__esModule=!0,e.fetchRankData=function(t,e,n,a){var i={};r(function(r){o(r,t,e,n,function(t){Object.assign(i,t),a&&a(i)})})};var a=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),r=function(t){a.default.getUserInfo({openIdList:["selfOpenId"],success:function(e){var n=e.data[0],a={playerId:n.openId,nickname:n.nickName,avatarUrl:n.avatarUrl};t&&t(a)}})},o=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments[4];a.default.getFriendCloudStorage({keyList:[e],success:function(a){var i=[];a&&a.data&&a.data.length>0&&(i=a.data);var u,l=-1,f=null,c=null,s=i.map(function(t){var n={};t.KVDataList.forEach(function(t){n[t.key]=t.value});var a,r=t.openid,o=t.nickname,i=t.avatarUrl,u=0,l=0,f=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t}return t}(n[e])||{};return a=f.extraData||"",f.wxgame&&(l=f.wxgame.score||0,u=f.wxgame.update_time||0),{playerId:r,nickname:o,avatarUrl:i,score:l,timestamp:u,extraData:a}}).sort(function(t,e){return e.score-t.score}).splice(r,n).map(function(e,n){var a=e.nickname===t.nickname&&e.avatarUrl===t.avatarUrl;return a&&(c=e,l=n,f={score:e.score,extraData:e.extraData}),Object.assign(e,{self:a,rank:n+1}),e});u=l<=0?s.slice(0,3):s.slice(l-1,l+1),o&&o({selfInfo:t,rankList:s,rankSelf:c,selfData:f,rankThree:u})}})}}])});