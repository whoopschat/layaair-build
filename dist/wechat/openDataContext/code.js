!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var a=e();for(var n in a)("object"==typeof exports?exports:t)[n]=a[n]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=1)}([function(t,e,a){"use strict";e.__esModule=!0;var n=function(t){for(var e=arguments.length,a=Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];var r;if(window.hasOwnProperty("wx")&&window.wx.hasOwnProperty(t))return(r=window.wx)[t].apply(r,a)},r="${env}",i=0,o=0,l=0,u=0;function s(t){if("production"!=r){for(var e,a=arguments.length,n=Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];(e=console).log.apply(e,["WXRank",t].concat(n))}}e.default={getOffestX:function(){return i},getOffestY:function(){return o},getDesignWidth:function(){return l},getDesignHeight:function(){return u},init:function(t){var e;console.log("WXRank","init,version:1.0.0"),Laya.MiniAdpter.init(!0,!0),Laya.init(750,1334),e=function(e){try{"filedata"===e.isLoad?(Laya.MiniFileMgr.ziyuFileData[e.url]=e.data,Laya.loader.load(e.url)):"filenative"==e.isLoad?e.isAdd?Laya.MiniFileMgr.filesListObj[e.url]=e.data:delete Laya.MiniFileMgr.filesListObj[e.url]:(s("OnMessage:",e),e.action&&"initRank"===e.action&&e.data?(Laya.stage.width=e.data.width,Laya.stage.height=e.data.height,i=e.data.offsetX,o=e.data.offsetY,l=e.data.designWidth,u=e.data.designHeight,Laya.stage.frameRate=Laya.Stage.FRAME_SLOW,Laya.stage.scaleMode=Laya.Stage.SCALE_EXACTFIT):t&&t(e))}catch(t){s("Error",t)}},n("onMessage",function(t){e&&e(t)})},setUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("setUserCloudStorage",t)},getUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getUserCloudStorage",t)},removeUserCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("removeUserCloudStorage",t)},getFriendCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getFriendCloudStorage",t)},getGroupCloudStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getGroupCloudStorage",t)},getUserInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n("getUserInfo",t)},printDebug:s}},function(t,e,a){"use strict";var n,r=a(0),i=(n=r)&&n.__esModule?n:{default:n},o=a(2);i.default.init(function(t){"showRank"===t.action&&t.data?(0,o.showRank)(t.data.ui):"hideRank"===t.action&&t.data?(0,o.hideRank)():"setRankKey"===t.action&&t.data?(0,o.setRankKey)(t.data.key,t.data.count,t.data.offset):"setRankScore"===t.action&&t.data&&(0,o.setRankScore)(t.data.key,t.data.score,t.data.extraData)})},function(t,e,a){"use strict";e.__esModule=!0,e.setRankKey=function(t,e,a){s=t,g=e,y=a,v()},e.setRankScore=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=[{key:t,value:JSON.stringify({wxgame:{score:e,update_time:Math.floor(Date.now()/1e3)},extraData:a})}];i.default.setUserCloudStorage({KVDataList:n,success:function(){t==s&&v()}})},e.showRank=function(t){f&&JSON.stringify(t)===JSON.stringify(f)||(f=t,function(){if(!f)return;if(Laya.stage.destroyChildren(),f instanceof Array)f.forEach(function(t){var e=Laya.View.createComp(t);e&&((0,o.bindView)(e,u),Laya.stage.addChild(e))});else{var t=Laya.View.createComp(f);t&&(t.x=i.default.getOffestX(),t.y=i.default.getOffestY(),(0,o.bindView)(t,u),Laya.stage.addChild(t))}}());v()},e.hideRank=function(){f=null,Laya.stage.destroyChildren()};var n,r=a(0),i=(n=r)&&n.__esModule?n:{default:n},o=a(3),l=a(4);var u={},s=null,f=null,c=!0,d=null,g=100,y=0;function v(){d||(d=setTimeout(function(){d=null,f&&s&&c&&(c=!1,(0,l.fetchRankData)(s,g,y,function(t){i.default.printDebug("rankData:",t),u=t,c=!0;for(var e=0;e<Laya.stage.numChildren;e++)(0,o.bindView)(Laya.stage.getChildAt(e),u)}))},200))}},function(t,e,a){"use strict";e.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t}return t}function i(t,e){var a=e.split("|"),n=a[0],i=r(t);if(t)if(t[n])i=r(t[n]);else{n.split(".").forEach(function(t){i=null!==i&&void 0!==i&&null!==i[t]&&void 0!==i[t]?r(i[t]):null})}else i=null;for(var o=[],l=1;l<a.length;l+=2){var u=a[l],s=a.length>l+1?a[l+1]:"";o.push({action:u,target:s})}for(var f=null,c=0;c<o.length;c++){var d=o[c],g=d.action,y=d.target;"default"===g&&(f=y),null!==i&&void 0!==i?"eq"===g&&y!==i.toString()||"neq"===g&&y===i.toString()||"gt"===g&&i<=y||"egt"===g&&i<y||"lt"===g&&i>=y||"elt"===g&&i>y||"like"===g&&i.toString().indexOf(y)<0?i=null:"sub"===g?1*y>0&&(i=i.toString().substr(0,1*y)):"append"===g&&(i=i.toString()+y):i=null}return null===i&&(i=f),i}e.bindView=function t(e,a){var o=this;var l=r(a);for(var u=0;u<e.numChildren;u++){var s=e.getChildAt(u);if(s.name){var f=i(l,s.name);null!==f&&void 0!==f?(s.visible=!0,s instanceof Laya.List?function(){var e=s;e.array=[],e.repeatX>1&&!e.hScrollBarSkin&&(e.hScrollBarSkin=null),e.repeatY>1&&!e.vScrollBarSkin&&(e.vScrollBarSkin=null),e.renderHandler=Laya.Handler.create(o,function(a,r){var i=e.array[r];"object"===(void 0===i?"undefined":n(i))&&Object.assign(i,{index:r}),t(a,i)},null,!1),e.array=f}():s instanceof Laya.FontClip?s.value=""+f:s instanceof Laya.Label?s.text=""+f:s instanceof Laya.Text?s.text=""+f:s instanceof Laya.Image?s.skin=f:s instanceof Laya.Box?t(s,f):s.value=f):s.visible=!1}}}},function(t,e,a){"use strict";e.__esModule=!0,e.fetchRankData=function(t,e,a,n){var r={};o(function(i){l(i,t,e,a,function(t){Object.assign(r,t),n&&n(r)})})};var n,r=a(0),i=(n=r)&&n.__esModule?n:{default:n};var o=function(t){i.default.getUserInfo({openIdList:["selfOpenId"],success:function(e){var a=e.data[0],n={playerId:a.openId,nickname:a.nickName,avatarUrl:a.avatarUrl};t&&t(n)}})},l=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments[4];i.default.getFriendCloudStorage({keyList:[e],success:function(i){var o=[];i&&i.data&&i.data.length>0&&(o=i.data);var l=-1,u=null,s=null,f=[],c=o.map(function(t){var a={};t.KVDataList.forEach(function(t){a[t.key]=t.value});var n,r=t.openid,i=t.nickname,o=t.avatarUrl,l=0,u=0,s=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t}return t}(a[e])||{};return n=s.extraData||"",s.wxgame&&(u=s.wxgame.score||0,l=s.wxgame.update_time||0),{playerId:r,nickname:i,avatarUrl:o,score:u,timestamp:l,extraData:n}}).sort(function(t,e){return e.score-t.score}).splice(n,a).map(function(e,a){var n=e.nickname===t.nickname&&e.avatarUrl===t.avatarUrl;return n&&(s=e,l=a,u={score:e.score,extraData:e.extraData}),Object.assign(e,{self:n,rank:a+1}),e});f=l<=0?c.slice(0,3):c.slice(l-1,l+1),r&&r({selfInfo:t,rankList:c,rankSelf:s,selfData:u,rankThree:f})}})}}])});